<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>FALAAI - Login / Cadastro</title>
<link rel="stylesheet" href="style.css" />
</head>
<body>
<div class="container login-container">
  <h1>FALAAI - Bem vindo!</h1>
  <div class="form-container">
    <form id="loginForm">
      <h2>Login</h2>
      <input type="text" id="loginUser" placeholder="Usuário" required />
      <input type="password" id="loginPass" placeholder="Senha" required />
      <button type="submit">Entrar</button>
      <p>Não tem conta? <a href="#" id="showRegister">Cadastre-se</a></p>
    </form>

    <form id="registerForm" style="display:none;">
      <h2>Cadastro</h2>
      <input type="text" id="regUser" placeholder="Usuário" required />
      <input type="password" id="regPass" placeholder="Senha" required />
      <input type="password" id="regPass2" placeholder="Confirme a senha" required />
      <button type="submit">Cadastrar</button>
      <p>Já tem conta? <a href="#" id="showLogin">Faça login</a></p>
    </form>
  </div>
</div>

<script>
const adminUser = {username: 'saintex', password: 'ffg..1.', isAdmin: true};

// Função para buscar usuários do localStorage
function getUsers() {
  return JSON.parse(localStorage.getItem('falaiUsers') || '[]');
}
// Salvar usuários no localStorage
function saveUsers(users) {
  localStorage.setItem('falaiUsers', JSON.stringify(users));
}

const loginForm = document.getElementById('loginForm');
const registerForm = document.getElementById('registerForm');
const showRegister = document.getElementById('showRegister');
const showLogin = document.getElementById('showLogin');

showRegister.addEventListener('click', e => {
  e.preventDefault();
  loginForm.style.display = 'none';
  registerForm.style.display = 'block';
});
showLogin.addEventListener('click', e => {
  e.preventDefault();
  loginForm.style.display = 'block';
  registerForm.style.display = 'none';
});

registerForm.addEventListener('submit', e => {
  e.preventDefault();
  const username = document.getElementById('regUser').value.trim();
  const pass1 = document.getElementById('regPass').value;
  const pass2 = document.getElementById('regPass2').value;
  if (pass1 !== pass2) return alert('Senhas não conferem.');
  let users = getUsers();
  if (users.find(u => u.username.toLowerCase() === username.toLowerCase()) || username.toLowerCase() === adminUser.username) {
    return alert('Usuário já existe.');
  }
  users.push({username, password: pass1, isAdmin:false, followers: [], following: [], posts: [], messages: {}});
  saveUsers(users);
  alert('Cadastro realizado! Agora faça login.');
  registerForm.reset();
  showLogin.click();
});

loginForm.addEventListener('submit', e => {
  e.preventDefault();
  const username = document.getElementById('loginUser').value.trim();
  const password = document.getElementById('loginPass').value;
  if(username === adminUser.username && password === adminUser.password) {
    localStorage.setItem('falaiCurrentUser', JSON.stringify(adminUser));
    window.location.href = 'app.html';
    return;
  }
  const users = getUsers();
  const user = users.find(u => u.username.toLowerCase() === username.toLowerCase() && u.password === password);
  if (!user) return alert('Usuário ou senha inválidos.');
  localStorage.setItem('falaiCurrentUser', JSON.stringify(user));
  window.location.href = 'app.html';
});
</script>
</body>
</html>
