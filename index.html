<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>FALAAI - Jornal Escolar Moderno</title>
  <style>
    /* RESET */
    * {
      margin: 0; padding: 0; box-sizing: border-box;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      transition: background-color 0.3s, color 0.3s;
    }

    body, html {
      height: 100%;
      background-color: var(--bg);
      color: var(--text);
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    :root {
      --bg: #f5f5f7;
      --text: #222;
      --primary: #0077ff;
      --card-bg: #fff;
      --input-bg: #e5e5e5;
      --border: #ddd;
      --shadow: rgba(0,0,0,0.05);
    }
    [data-theme="dark"] {
      --bg: #121212;
      --text: #ddd;
      --primary: #3399ff;
      --card-bg: #1f1f1f;
      --input-bg: #333;
      --border: #444;
      --shadow: rgba(0,0,0,0.6);
    }

    header {
      padding: 1rem;
      background: var(--card-bg);
      box-shadow: 0 1px 6px var(--shadow);
      text-align: center;
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--primary);
      user-select: none;
    }

    main {
      flex: 1;
      overflow-y: auto;
      padding: 1rem;
    }

    /* MENU INFERIOR */
    nav {
      display: flex;
      justify-content: space-around;
      background: var(--card-bg);
      box-shadow: 0 -1px 6px var(--shadow);
      padding: 0.5rem 0;
      position: fixed;
      bottom: 0;
      width: 100%;
      user-select: none;
      z-index: 1000;
    }
    nav button {
      background: none;
      border: none;
      font-size: 1rem;
      color: var(--text);
      display: flex;
      flex-direction: column;
      align-items: center;
      cursor: pointer;
      padding: 0.2rem 0.5rem;
      gap: 0.2rem;
      transition: color 0.3s;
    }
    nav button.active, nav button:hover {
      color: var(--primary);
    }
    nav button svg {
      width: 24px;
      height: 24px;
      fill: currentColor;
    }

    /* FEED */
    .post {
      background: var(--card-bg);
      border-radius: 10px;
      box-shadow: 0 4px 8px var(--shadow);
      margin-bottom: 1.2rem;
      padding: 1rem;
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
      animation: fadeInUp 0.4s ease forwards;
    }
    .post-header {
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }
    .post-header img {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      object-fit: cover;
      cursor: pointer;
      border: 2px solid transparent;
      transition: border-color 0.3s;
    }
    .post-header img:hover {
      border-color: var(--primary);
    }
    .post-header .user-info {
      font-weight: 600;
      color: var(--primary);
      cursor: pointer;
    }
    .post-content {
      font-size: 1rem;
      line-height: 1.3;
      color: var(--text);
    }
    .post-actions {
      display: flex;
      gap: 1rem;
      align-items: center;
    }
    .post-actions button {
      background: none;
      border: none;
      cursor: pointer;
      color: var(--text);
      display: flex;
      align-items: center;
      gap: 0.3rem;
      font-size: 1rem;
      transition: color 0.3s;
    }
    .post-actions button.liked {
      color: var(--primary);
    }
    .post-actions button:hover {
      color: var(--primary);
    }
    .post-comments {
      margin-top: 0.5rem;
      max-height: 150px;
      overflow-y: auto;
      background: var(--input-bg);
      border-radius: 8px;
      padding: 0.5rem;
    }
    .comment {
      font-size: 0.9rem;
      margin-bottom: 0.3rem;
      color: var(--text);
    }
    .comment strong {
      color: var(--primary);
    }
    .add-comment {
      display: flex;
      gap: 0.5rem;
      margin-top: 0.5rem;
    }
    .add-comment input {
      flex: 1;
      border-radius: 20px;
      border: 1px solid var(--border);
      padding: 0.4rem 1rem;
      background: var(--input-bg);
      color: var(--text);
      font-size: 0.9rem;
    }
    .add-comment button {
      border: none;
      border-radius: 20px;
      background: var(--primary);
      color: white;
      padding: 0 1rem;
      font-weight: 700;
      cursor: pointer;
      transition: background-color 0.3s;
    }
    .add-comment button:hover {
      background-color: #005ecb;
    }

    /* PERFIL */
    .profile-page {
      max-width: 400px;
      margin: 0 auto;
      text-align: center;
    }
    .profile-avatar {
      margin-bottom: 1rem;
      position: relative;
      display: inline-block;
    }
    .profile-avatar img {
      width: 120px;
      height: 120px;
      border-radius: 50%;
      object-fit: cover;
      border: 4px solid var(--primary);
      cursor: pointer;
    }
    .profile-avatar input[type="file"] {
      display: none;
    }
    .profile-info {
      margin-bottom: 1rem;
    }
    .profile-info input, .profile-info textarea {
      width: 100%;
      padding: 0.5rem;
      margin-top: 0.3rem;
      border-radius: 8px;
      border: 1px solid var(--border);
      background: var(--input-bg);
      color: var(--text);
      font-size: 1rem;
      resize: none;
    }
    .profile-info label {
      font-weight: 600;
      color: var(--primary);
    }
    .save-profile-btn {
      background: var(--primary);
      color: white;
      border: none;
      padding: 0.7rem 1.2rem;
      border-radius: 30px;
      font-weight: 700;
      cursor: pointer;
      transition: background-color 0.3s;
      width: 100%;
      margin-top: 1rem;
    }
    .save-profile-btn:hover {
      background-color: #005ecb;
    }

    /* PESQUISA */
    .search-page {
      max-width: 500px;
      margin: 0 auto;
    }
    .search-input {
      width: 100%;
      padding: 0.7rem 1rem;
      border-radius: 30px;
      border: 1px solid var(--border);
      background: var(--input-bg);
      color: var(--text);
      font-size: 1rem;
      margin-bottom: 1rem;
    }
    .search-results {
      max-height: 400px;
      overflow-y: auto;
    }
    .search-item {
      padding: 0.5rem 1rem;
      border-bottom: 1px solid var(--border);
      cursor: pointer;
      color: var(--primary);
      font-weight: 600;
    }
    .search-item:hover {
      background: var(--input-bg);
    }

    /* LOGIN/CADASTRO MODAL */
    .modal-bg {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.5);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1500;
    }
    .modal {
      background: var(--card-bg);
      padding: 2rem;
      border-radius: 12px;
      width: 90%;
      max-width: 380px;
      box-shadow: 0 4px 20px var(--shadow);
      position: relative;
      animation: fadeInScale 0.3s ease forwards;
    }
    .modal h2 {
      text-align: center;
      margin-bottom: 1rem;
      color: var(--primary);
    }
    .modal label {
      display: block;
      margin-top: 1rem;
      font-weight: 600;
      color: var(--primary);
    }
    .modal input {
      width: 100%;
      padding: 0.5rem 1rem;
      margin-top: 0.3rem;
      border-radius: 10px;
      border: 1px solid var(--border);
      background: var(--input-bg);
      color: var(--text);
      font-size: 1rem;
    }
    .modal button {
      margin-top: 1.5rem;
      background: var(--primary);
      border: none;
      color: white;
      font-weight: 700;
      padding: 0.7rem;
      border-radius: 30px;
      cursor: pointer;
      width: 100%;
      transition: background-color 0.3s;
    }
    .modal button:hover {
      background-color: #005ecb;
    }
    .close-modal {
      position: absolute;
      top: 10px;
      right: 15px;
      font-size: 1.3rem;
      cursor: pointer;
      color: var(--primary);
    }

    /* DARK MODE TOGGLE */
    .dark-mode-toggle {
      position: fixed;
      top: 1rem;
      right: 1rem;
      cursor: pointer;
      background: var(--card-bg);
      border-radius: 50%;
      padding: 0.5rem;
      box-shadow: 0 2px 8px var(--shadow);
      user-select: none;
      z-index: 2000;
    }
    .dark-mode-toggle svg {
      fill: var(--primary);
      width: 28px;
      height: 28px;
      transition: transform 0.3s;
    }
    .dark-mode-toggle:hover svg {
      transform: rotate(20deg);
    }

    /* ANIMAÇÕES */
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    @keyframes fadeInScale {
      from {
        opacity: 0;
        transform: scale(0.8);
      }
      to {
        opacity: 1;
        transform: scale(1);
      }
    }

    /* RESPONSIVO */
    @media (max-width: 600px) {
      nav button span {
        font-size: 0.7rem;
      }
      .profile-avatar img {
        width: 90px;
        height: 90px;
      }
    }
  </style>
</head>
<body>
  <header>FALAAI</header>

  <main id="app">

    <!-- Páginas (visíveis só uma de cada vez) -->
    <section id="feed-page" class="page">
      <div id="feed-list"></div>
    </section>

    <section id="profile-page" class="page" style="display:none;">
      <div class="profile-page">
        <div class="profile-avatar">
          <label for="avatar-input">
            <img id="profile-avatar-img" src="https://i.pravatar.cc/150?img=3" alt="Avatar" title="Clique para mudar"/>
          </label>
          <input type="file" id="avatar-input" accept="image/*" />
        </div>
        <div class="profile-info">
          <label>Nome</label>
          <input type="text" id="profile-name" placeholder="Seu nome" />
          <label>Bio</label>
          <textarea id="profile-bio" rows="3" placeholder="Fale sobre você"></textarea>
          <button class="save-profile-btn" id="save-profile-btn">Salvar Perfil</button>
        </div>
      </div>
    </section>

    <section id="search-page" class="page" style="display:none;">
      <div class="search-page">
        <input type="text" class="search-input" placeholder="Pesquisar usuários..." id="search-input" />
        <div class="search-results" id="search-results"></div>
      </div>
    </section>

  </main>

  <nav>
    <button id="nav-feed" class="active" aria-label="Feed">
      <svg viewBox="0 0 24 24"><path d="M4 4h16v2H4zM4 9h16v2H4zM4 14h10v2H4z"/></svg>
      <span>Feed</span>
    </button>
    <button id="nav-search" aria-label="Pesquisar">
      <svg viewBox="0 0 24 24"><path d="M10 2a8 8 0 105.293 14.293l4.707 4.707 1.414-1.414-4.707-4.707A8 8 0 0010 2zm0 2a6 6 0 11-4.243 10.243A6 6 0 0110 4z"/></svg>
      <span>Pesquisar</span>
    </button>
    <button id="nav-profile" aria-label="Perfil">
      <svg viewBox="0 0 24 24"><path d="M12 12a5 5 0 100-10 5 5 0 000 10zm0 2c-3.33 0-10 1.67-10 5v3h20v-3c0-3.33-6.67-5-10-5z"/></svg>
      <span>Perfil</span>
    </button>
  </nav>

  <div class="dark-mode-toggle" title="Alternar modo claro/escuro" aria-label="Toggle dark mode" role="button" tabindex="0">
    <svg viewBox="0 0 24 24"><path d="M12 3a9 9 0 000 18 9 9 0 000-18zm0 16a7 7 0 010-14 7 7 0 010 14z"/></svg>
  </div>

  <!-- Modal login/cadastro -->
  <div id="modal-auth" class="modal-bg" style="display:none;">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="modal-title">
      <span class="close-modal" id="close-modal" aria-label="Fechar modal" tabindex="0">&times;</span>
      <h2 id="modal-title">Entrar no FALAAI</h2>
      <label for="input-username">Usuário</label>
      <input type="text" id="input-username" autocomplete="username" />
      <label for="input-password">Senha</label>
      <input type="password" id="input-password" autocomplete="current-password" />
      <button id="btn-login">Entrar</button>
      <p style="margin-top:1rem; font-size:0.9rem; text-align:center;">
        Não tem conta? <a href="#" id="show-register">Cadastre-se</a>
      </p>
    </div>
  </div>

  <div id="modal-register" class="modal-bg" style="display:none;">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="modal-register-title">
      <span class="close-modal" id="close-register" aria-label="Fechar modal" tabindex="0">&times;</span>
      <h2 id="modal-register-title">Cadastre-se no FALAAI</h2>
      <label for="register-username">Usuário</label>
      <input type="text" id="register-username" />
      <label for="register-password">Senha</label>
      <input type="password" id="register-password" />
      <button id="btn-register">Cadastrar</button>
      <p style="margin-top:1rem; font-size:0.9rem; text-align:center;">
        Já tem conta? <a href="#" id="show-login">Entrar</a>
      </p>
    </div>
  </div>

<script>
  // Estado global simples
  let currentUser = null;
  let users = JSON.parse(localStorage.getItem('users')) || {};
  let posts = JSON.parse(localStorage.getItem('posts')) || [
    {
      id: 'p1',
      author: 'admin',
      authorName: 'FALAAI Admin',
      authorAvatar: 'https://i.pravatar.cc/150?img=12',
      content: 'Bem-vindos ao FALAAI, seu jornal escolar moderno e interativo!',
      likes: [],
      comments: []
    },
    {
      id: 'p2',
      author: 'user1',
      authorName: 'Maria Silva',
      authorAvatar: 'https://i.pravatar.cc/150?img=15',
      content: 'Hoje tivemos uma aula incrível sobre astronomia! 🚀✨',
      likes: ['admin'],
      comments: [{user:'admin', text:'Que demais!'}]
    }
  ];

  // Utils
  function saveAll() {
    localStorage.setItem('users', JSON.stringify(users));
    localStorage.setItem('posts', JSON.stringify(posts));
  }

  function renderFeed() {
    const feedList = document.getElementById('feed-list');
    feedList.innerHTML = '';
    posts.slice().reverse().forEach(post => {
      const liked = currentUser && post.likes.includes(currentUser);
      const postEl = document.createElement('article');
      postEl.className = 'post';
      postEl.innerHTML = `
        <div class="post-header">
          <img src="${post.authorAvatar}" alt="${post.authorName}" title="${post.authorName}" />
          <div class="user-info">${post.authorName}</div>
        </div>
        <div class="post-content">${post.content}</div>
        <div class="post-actions">
          <button class="like-btn ${liked ? 'liked' : ''}" aria-label="Curtir post">&#10084;</button>
          <span>${post.likes.length}</span>
        </div>
        <div class="post-comments">
          ${post.comments.map(c => `<div class="comment"><strong>${c.user}:</strong> ${c.text}</div>`).join('')}
          ${currentUser ? `
          <div class="add-comment">
            <input type="text" placeholder="Comentar..." aria-label="Campo para comentar" />
            <button>Enviar</button>
          </div>
          ` : '<p style="font-style:italic; font-size:0.8rem; color:var(--primary);">Entre para comentar</p>'}
        </div>
      `;

      // Like btn
      postEl.querySelector('.like-btn').onclick = () => {
        if (!currentUser) {
          alert('Entre para curtir!');
          openModal('login');
          return;
        }
        if (post.likes.includes(currentUser)) {
          post.likes = post.likes.filter(u => u !== currentUser);
        } else {
          post.likes.push(currentUser);
        }
        saveAll();
        renderFeed();
      };

      // Comment btn
      if (currentUser) {
        const commentInput = postEl.querySelector('.add-comment input');
        const commentBtn = postEl.querySelector('.add-comment button');
        commentBtn.onclick = () => {
          const text = commentInput.value.trim();
          if (!text) return alert('Escreva algo para comentar!');
          post.comments.push({user: currentUser, text});
          commentInput.value = '';
          saveAll();
          renderFeed();
        };
      }

      feedList.appendChild(postEl);
    });
  }

  function openModal(mode) {
    if(mode === 'login'){
      document.getElementById('modal-auth').style.display = 'flex';
      document.getElementById('modal-register').style.display = 'none';
    } else if(mode === 'register'){
      document.getElementById('modal-auth').style.display = 'none';
      document.getElementById('modal-register').style.display = 'flex';
    }
  }
  function closeModals() {
    document.getElementById('modal-auth').style.display = 'none';
    document.getElementById('modal-register').style.display = 'none';
  }

  function showPage(pageId) {
    document.querySelectorAll('main .page').forEach(p => {
      p.style.display = p.id === pageId ? 'block' : 'none';
    });
    document.querySelectorAll('nav button').forEach(btn => {
      btn.classList.remove('active');
    });
    document.getElementById('nav-' + pageId.split('-')[0]).classList.add('active');
  }

  // Perfil
  function loadProfile() {
    if (!currentUser) return;
    const user = users[currentUser];
    document.getElementById('profile-name').value = user.name || currentUser;
    document.getElementById('profile-bio').value = user.bio || '';
    document.getElementById('profile-avatar-img').src = user.avatar || `https://i.pravatar.cc/150?u=${currentUser}`;
  }
  function saveProfile() {
    if (!currentUser) return alert('Entre para salvar perfil!');
    users[currentUser] = users[currentUser] || {};
    users[currentUser].name = document.getElementById('profile-name').value.trim() || currentUser;
    users[currentUser].bio = document.getElementById('profile-bio').value.trim();
    users[currentUser].avatar = document.getElementById('profile-avatar-img').src;
    saveAll();
    alert('Perfil salvo!');
  }

  // Avatar input change
  document.getElementById('avatar-input').addEventListener('change', e => {
    if (!e.target.files || e.target.files.length === 0) return;
    const file = e.target.files[0];
    const reader = new FileReader();
    reader.onload = evt => {
      document.getElementById('profile-avatar-img').src = evt.target.result;
    };
    reader.readAsDataURL(file);
  });

  // Dark mode toggle
  const darkModeToggle = document.querySelector('.dark-mode-toggle');
  darkModeToggle.onclick = () => {
    document.body.classList.toggle('dark-mode');
  };

  // Navegação
  document.getElementById('nav-feed').onclick = () => { showPage('feed-page'); renderFeed(); };
  document.getElementById('nav-search').onclick = () => { showPage('search-page'); };
  document.getElementById('nav-profile').onclick = () => {
    if (!currentUser) {
      openModal('login');
      return;
    }
    showPage('profile-page');
    loadProfile();
  };

  // Login / Registro
  document.getElementById('btn-login').onclick = () => {
    const username = document.getElementById('input-username').value.trim();
    const password = document.getElementById('input-password').value;
    if (!username || !password) return alert('Preencha todos os campos!');
    if (!users[username] || users[username].password !== password) {
      alert('Usuário ou senha incorretos!');
      return;
    }
    currentUser = username;
    closeModals();
    showPage('feed-page');
    renderFeed();
  };

  document.getElementById('btn-register').onclick = () => {
    const username = document.getElementById('register-username').value.trim();
    const password = document.getElementById('register-password').value;
    if (!username || !password) return alert('Preencha todos os campos!');
    if (users[username]) return alert('Usuário já existe!');
    users[username] = {password};
    saveAll();
    alert('Cadastro realizado com sucesso!');
    closeModals();
  };

  document.getElementById('show-register').onclick = e => {
    e.preventDefault();
    openModal('register');
  };
  document.getElementById('show-login').onclick = e => {
    e.preventDefault();
    openModal('login');
  };

  document.getElementById('close-modal').onclick = closeModals;
  document.getElementById('close-register').onclick = closeModals;

  // Busca de usuários (simples)
  document.getElementById('search-input').addEventListener('input', e => {
    const query = e.target.value.toLowerCase();
    const results = Object.entries(users)
      .filter(([username, user]) => username.toLowerCase().includes(query) || (user.name && user.name.toLowerCase().includes(query)));
    const container = document.getElementById('search-results');
    container.innerHTML = results.length
      ? results.map(([username, user]) => `
        <div class="user-result">
          <img src="${user.avatar || `https://i.pravatar.cc/150?u=${username}`}" alt="${username}" />
          <div>
            <strong>${user.name || username}</strong><br/>
            <small>@${username}</small>
          </div>
        </div>
      `).join('')
      : '<p>Nenhum usuário encontrado.</p>';
  });

  // Inicializa feed
  renderFeed();
</script>

</body>
</html>
